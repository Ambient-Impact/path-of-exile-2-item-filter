{% import 'macros/tiered_scheme.' + itemFilter.templateExtension as tieredScheme with context -%}
{% import 'macros/utilities.' + itemFilter.templateExtension as utilities -%}

# Salvage bench materials during campaign.
Show
  AreaLevel       < {{ itemFilter.levels.endgameStart }}
  Sockets         >= 1
  Rarity          <= Rare
  {{ tieredScheme.output('salvage', 'b') }}
  PlayEffect      Grey Temp
  MinimapIcon     2 Grey Circle
  # Allow other rules after this to apply their own values if they match.
  Continue
Show
  AreaLevel       < {{ itemFilter.levels.endgameStart }}
  Quality         >= 1 # @todo Higher minimum?
  Rarity          <= Rare
  {{ tieredScheme.output('salvage', 'b') }}
  PlayEffect      Grey Temp
  MinimapIcon     2 Grey Circle
  # Allow other rules after this to apply their own values if they match.
  Continue

# Salvage bench materials during endgame.

# Arcanist's Etchers and Glassblower's Baubles are relatively rare so they're
# worth salvaging even during endgame.
Show
  AreaLevel       >= {{ itemFilter.levels.endgameStart }}
  Class           {{ utilities.quotedSequence([
    'Charm',
    'Flask',
    'Sceptre',
    'Stave',
    'Wand',
  ]) }}
  Quality         >= 1
  Rarity          <= Rare
  {{ tieredScheme.output('salvage', 'b') }}
  PlayEffect      Grey Temp
  MinimapIcon     2 Grey Circle
  # Allow other rules after this to apply their own values if they match.
  Continue

{# Minimum quality we're interested in for salvaging during endgame. #}
{%- set endgameQualityMin = 11 -%}

# Items only one square wide in the inventory.
Show
  Width         1
  Height        >= 3
  Quality       >= {{ endgameQualityMin }}
  {{ tieredScheme.output('salvage', 'b') }}
  PlayEffect    Grey Temp
  MinimapIcon   1 Grey Diamond
  Continue

# Items no larger than 2 squares in either direction.
Show
  Width         <= 2
  Height        <= 2
  Quality       >= {{ endgameQualityMin }}
  {{ tieredScheme.output('salvage', 'b') }}
  PlayEffect    Grey Temp
  MinimapIcon   1 Grey Diamond
  Continue
